{
    "editable": true,
    "panels": [
      {
        "collapsed": false,
        "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
        "id": 1,
        "title": "Core Infrastructure Health",
        "type": "row"
      },
      {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "thresholds" },
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "color": "red", "value": null },
                { "color": "green", "value": 1 }
              ]
            }
          }
        },
        "gridPos": { "h": 4, "w": 6, "x": 0, "y": 1 },
        "id": 2,
        "title": "Scheduler Status",
        "type": "stat",
        "targets": [
          { "expr": "sum(increase(airflow_scheduler_heartbeat_total{job=\"$job\"}[2m]))", "refId": "A" }
        ]
      },
      {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "gridPos": { "h": 4, "w": 6, "x": 6, "y": 1 },
        "id": 3,
        "title": "Running Tasks (Executor)",
        "type": "stat",
        "targets": [
          { "expr": "sum(airflow_executor_running_tasks{job=\"$job\"})", "refId": "A" }
        ]
      },
      {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "gridPos": { "h": 4, "w": 6, "x": 12, "y": 1 },
        "id": 4,
        "title": "Queued Tasks (Executor)",
        "type": "stat",
        "targets": [
          { "expr": "sum(airflow_executor_queued_tasks{job=\"$job\"})", "refId": "A" }
        ]
      },
      {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 5 },
      "id": 5,
      "title": "Avg Scheduling Delay (Seconds)",
      "type": "timeseries",
      "targets": [
        { "expr": "avg(airflow_dagrun_schedule_delay{job=\"$job\"})", "legendFormat": "Schedule Delay", "refId": "A" }
      ]
    },
    {
      "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 5 },
      "id": 6,
      "title": "Successful DAG Run Durations",
      "type": "timeseries",
      "targets": [
        { "expr": "airflow_dagrun_duration_success{job=\"$job\"}", "legendFormat": "{{dag_id}}", "refId": "A" }
      ]
    },
    {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 5 },
        "id": 5,
        "title": "Avg Scheduling Delay (Seconds)",
        "type": "timeseries",
        "targets": [
          { "expr": "avg(airflow_dagrun_schedule_delay{job=\"$job\"})", "legendFormat": "Schedule Delay", "refId": "A" }
        ]
      },
      {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 5 },
        "id": 6,
        "title": "Successful DAG Run Durations",
        "type": "timeseries",
        "targets": [
          { "expr": "airflow_dagrun_duration_success{job=\"$job\"}", "legendFormat": "{{dag_id}}", "refId": "A" }
        ]
      },
      {
        "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
        "gridPos": { "h": 8, "w": 24, "x": 0, "y": 13 },
        "id": 7,
        "title": "Pool Usage (Running vs Queued)",
        "type": "timeseries",
        "targets": [
          { "expr": "sum by (pool) (airflow_pool_running_slots{job=\"$job\"})", "legendFormat": "Running: {{pool}}", "refId": "A" },
          { "expr": "sum by (pool) (airflow_pool_queued_slots{job=\"$job\"})", "legendFormat": "Queued: {{pool}}", "refId": "B" }
        ]
      }
    ],
    "templating": {
      "list": [
        {
          "name": "DS_PROMETHEUS",
          "query": "prometheus",
          "refresh": 1,
          "type": "datasource"
        },
        {
          "datasource": { "type": "prometheus", "uid": "${DS_PROMETHEUS}" },
          "name": "job",
          "query": "label_values(airflow_scheduler_heartbeat_total, job)",
          "refresh": 1,
          "type": "query"
        }
      ]
    },
    "title": "Airflow 3.0+ OTel Native Dashboard",
    "uid": "airflow-3-native",
    "version": 1
  }
  

